<div class="justify-end flex mb-2">
  <button nz-button nzType="primary" (click)="openCreateMeetingModal()">+ Tạo lịch hẹn</button>
</div>

<div class="border-b border-gray-300 mb-4">
  <div class="flex">
    <a
      class="flex items-center p-2 xl:px-4 border-b-2"
      (click)="onMeetingStatusFilterChange()"
      [ngClass]="{
        ' border-green-500 font-medium text-green-600': meetingStatusFilterOptions === undefined,
        ' font-medium text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300': meetingStatusFilterOptions !== undefined
      }"
    >
      <mat-icon fontIcon="list"></mat-icon>
      <span class="hidden md:inline ml-1 text-sm">Tất cả</span>
    </a>
    <a
      class="flex items-center p-2 xl:px-4 border-b-2"
      (click)="onMeetingStatusFilterChange(MeetingStatus.PROPOSED)"
      [ngClass]="{
        ' border-green-500 font-medium text-green-600': meetingStatusFilterOptions === MeetingStatus.PROPOSED,
        ' font-medium text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300': meetingStatusFilterOptions !== MeetingStatus.PROPOSED
      }"
    >
      <mat-icon fontIcon="schedule"></mat-icon>
      <span class="hidden md:inline ml-1 text-sm">{{ MeetingLabel[MeetingStatus.PROPOSED] }}</span>
    </a>
    <a
      class="flex items-center p-2 xl:px-4 border-b-2"
      (click)="onMeetingStatusFilterChange(MeetingStatus.ONGOING)"
      [ngClass]="{
        ' border-green-500 font-medium text-green-600': meetingStatusFilterOptions === MeetingStatus.ONGOING,
        ' font-medium text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300': meetingStatusFilterOptions !== MeetingStatus.ONGOING
      }"
    >
      <mat-icon fontIcon="sync"></mat-icon>
      <span class="hidden md:inline ml-1 text-sm">{{ MeetingLabel[MeetingStatus.ONGOING] }}</span>
    </a>
    <a
      class="flex items-center p-2 xl:px-4 border-b-2"
      (click)="onMeetingStatusFilterChange(MeetingStatus.FINISHED)"
      [ngClass]="{
        ' border-green-500 font-medium text-green-600': meetingStatusFilterOptions === MeetingStatus.FINISHED,
        ' font-medium text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300': meetingStatusFilterOptions !== MeetingStatus.FINISHED
      }"
    >
      <mat-icon fontIcon="done"></mat-icon>
      <span class="hidden md:inline ml-1 text-sm">{{ MeetingLabel[MeetingStatus.FINISHED] }}</span>
    </a>
    <a
      class="flex items-center p-2 xl:px-4 border-b-2"
      (click)="onMeetingStatusFilterChange(MeetingStatus.CANCELLED)"
      [ngClass]="{
        ' border-green-500 font-medium text-green-600': meetingStatusFilterOptions === MeetingStatus.CANCELLED,
        ' font-medium text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300': meetingStatusFilterOptions !== MeetingStatus.CANCELLED
      }"
    >
      <mat-icon fontIcon="cancel"></mat-icon>
      <span class="hidden md:inline ml-1 text-sm">{{ MeetingLabel[MeetingStatus.CANCELLED] }}</span>
    </a>
  </div>
</div>
<nz-table
  [nzFrontPagination]="false"
  [nzData]="listMeeting.data"
  nzBordered="true"
  nzSize="small"
  [nzLoading]="isLoading"
  [nzPageIndex]="listMeeting.page"
  [nzPageSize]="listMeeting.size"
  [nzTotal]="listMeeting.total"
  (nzPageIndexChange)="onPageIndexChange($event)"
  class="custom-table"
>
  <thead>
    <tr>
      <th>Tiêu Đề</th>
      <th>Cột Mốc</th>
      <th nzWidth="200px">Thời Gian Bắt Đầu</th>
      <th nzWidth="200px">Thời Gian Kết Thúc</th>
      <th nzWidth="120px">Trạng Thái</th>
      <th nzWidth="20px"></th>
    </tr>
  </thead>
  <tbody>
    @for (meeting of listMeeting.data; track $index) {

    <tr>
      <td>{{ meeting.title }}</td>
      <td>{{ meeting.milestoneName || 'Không có' }}</td>
      <td>{{ formatDate(meeting.appointmentTime) }}</td>
      <td>{{ meeting.appointmentEndTime ? formatDate(meeting.appointmentEndTime) : 'Chưa có giờ kết thúc' }}</td>
      <td>
        <nz-tag class="w-full text-center" [nzColor]="getStatusColor(meeting.status)">
          {{ MeetingLabel[meeting.status] }}
        </nz-tag>
      </td>
      <td class="flex gap-2">
        <button (click)="openMeetingDetail(meeting)"><mat-icon class="text-blue-500 cursor-pointer"> info </mat-icon></button>
        @if (meeting.status === 3 || meeting.status === 4) {
        <button><mat-icon class="text-gray-300 cursor-not-allowed"> block </mat-icon></button>
        } @else {
        <button (click)="openCancelMeetingModal(meeting)"><mat-icon class="text-red-500 cursor-pointer"> block </mat-icon></button>
        }
      </td>
    </tr>
    }
  </tbody>
</nz-table>
